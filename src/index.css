*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:      #111114;
  --surface: #19191F;
  --panel:   #1E1E26;
  --border:  #2C2C38;
  --border2: #383848;
  --moss:    #4EB87A;
  --moss-l:  #5FCC8E;
  --moss-d:  #163024;
  --ink:     #EEECEA;
  --ink-s:   #A8A5A0;
  --ink-m:   #5E5C58;
  --blush:   #E8886A;
  --sky:     #6FA3C8;
  --sky-d:   #14222E;
  --r:       12px;
}

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--ink);
  height: 100vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

#root {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

/* ── TOP BAR ── */
.topbar {
  display:flex; align-items:center; justify-content:space-between;
  padding:0 20px; height:50px;
  background:var(--surface); border-bottom:1px solid var(--border);
  flex-shrink:0;
}

.logo { display:flex; align-items:center; gap:8px; }
.logo-mark {
  width:28px; height:28px; background:var(--moss);
  border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:13px;
}
.logo-name { font-family:'Lora',serif; font-size:19px; font-weight:500; letter-spacing:-0.3px; }
.logo-name span { color:var(--moss); }

.topbar-pills {
  display:flex; gap:3px; background:var(--bg); border-radius:30px; padding:3px;
}
.pill {
  padding:5px 16px; border-radius:24px; font-size:12px; font-weight:500;
  cursor:pointer; border:none; background:transparent; color:var(--ink-s); transition:all .16s;
}
.pill.active { background:var(--panel); color:var(--ink); box-shadow:0 2px 8px rgba(0,0,0,.3); }

.topbar-right { display:flex; align-items:center; gap:10px; }

.send-all-btn {
  display:flex; align-items:center; gap:5px;
  padding:7px 15px; border-radius:20px; border:none;
  background:var(--blush); color:white;
  font-family:'DM Sans',sans-serif; font-size:12px; font-weight:600;
  cursor:pointer; transition:all .18s;
}
.send-all-btn:hover { background:#D97655; transform:translateY(-1px); box-shadow:0 4px 14px rgba(232,136,106,.35); }

.avatar {
  width:28px; height:28px; border-radius:50%;
  background:linear-gradient(135deg, var(--moss), var(--sky));
  display:flex; align-items:center; justify-content:center;
  color:white; font-size:10px; font-weight:700; cursor:pointer;
}

/* ── MAIN ── */
.main { flex:1; display:flex; overflow:hidden; }

/* ── SIDEBAR ── */
.sidebar {
  width:54px; background:var(--surface); border-right:1px solid var(--border);
  display:flex; flex-direction:column; align-items:center;
  padding:12px 0; gap:3px; flex-shrink:0;
}
.sicon {
  width:36px; height:36px; border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:15px; transition:all .15s;
}
.sicon:hover { background:var(--border); color:var(--ink); }
.sicon.active { background:var(--moss-d); color:var(--moss); }
.sidebar-spacer { flex:1; }

/* ── CONTENT AREA (Account Switcher + Panels) ── */
.content-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* ── ACCOUNT SWITCHER DROPDOWN ── */
.account-switcher {
  position: relative;
  padding: 12px 16px;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

/* Main display button showing active account */
.account-display {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 14px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s ease;
  width: 100%;
  font-family: 'DM Sans', sans-serif;
}

.account-display:hover {
  background: var(--bg);
  border-color: var(--border2);
}

.account-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.account-email-main {
  flex: 1;
  font-size: 13px;
  font-weight: 500;
  color: var(--ink);
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.account-badge {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.4px;
  text-transform: uppercase;
  color: white;
  padding: 3px 7px;
  border-radius: 10px;
  flex-shrink: 0;
  white-space: nowrap;
}

.account-arrow {
  font-size: 9px;
  color: var(--ink-m);
  flex-shrink: 0;
  margin-left: 4px;
}

/* Dropdown menu */
.account-dropdown {
  position: absolute;
  top: calc(100% - 8px);
  left: 16px;
  right: 16px;
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 10px;
  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.5);
  z-index: 100;
  overflow: hidden;
  animation: dropdownSlide 0.18s ease;
}

@keyframes dropdownSlide {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.account-dropdown-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: transparent;
  border: none;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  transition: all 0.14s ease;
  width: 100%;
  font-family: 'DM Sans', sans-serif;
}

.account-dropdown-item:last-child {
  border-bottom: none;
}

.account-dropdown-item:hover {
  background: var(--surface);
}

.account-dropdown-item.active {
  background: var(--moss-d);
}

.account-dropdown-email {
  flex: 1;
  font-size: 12px;
  font-weight: 500;
  color: var(--ink);
  text-align: left;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.account-dropdown-badge {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.4px;
  text-transform: uppercase;
  color: white;
  padding: 3px 7px;
  border-radius: 10px;
  flex-shrink: 0;
}

.account-check {
  font-size: 11px;
  color: var(--moss);
  font-weight: 700;
  flex-shrink: 0;
}

/* ── THREE PANELS ── */
.panels {
  flex: 1;
  display: flex;
  overflow: hidden;
}

/* Wrapper div around each panel component */
.panel-wrap {
  display: flex;
  overflow: hidden;
  flex-shrink: 0;
}

/* Drag divider between panels */
.panel-div {
  width: 4px;
  flex-shrink: 0;
  background: var(--border);
  cursor: col-resize;
  transition: background .15s;
  position: relative;
  z-index: 10;
}
.panel-div:hover { background: var(--moss); }

.panel {
  display: flex; flex-direction: column; overflow: hidden;
  padding: 18px 16px 14px; gap: 12px;
  flex: 1; /* fill the .panel-wrap wrapper */
  min-width: 0;
}

.p1 { background:var(--bg); }
.p2 { background:var(--panel); }
.p3 { background:var(--panel); }

/* ── PANEL HEADER ── */
.ph { display:flex; align-items:center; gap:8px; flex-shrink:0; }
.step {
  width:20px; height:20px; border-radius:6px;
  display:flex; align-items:center; justify-content:center;
  font-size:10px; font-weight:700; flex-shrink:0;
}
.p1 .step { background:var(--moss-d); color:var(--moss); }
.p2 .step { background:var(--sky-d); color:var(--sky); }
.p3 .step { background:rgba(232,136,106,.15); color:var(--blush); }

.ptitle { font-family:'Lora',serif; font-size:14px; font-weight:500; }
.psub { margin-left:auto; font-size:11px; color:var(--ink-m); }

/* ── CHAT ── */
.chat-area {
  flex:1; overflow-y:auto;
  display:flex; flex-direction:column; gap:10px;
  padding-right:2px; min-height:0;
}
.chat-area::-webkit-scrollbar { width:3px; }
.chat-area::-webkit-scrollbar-thumb { background:var(--border2); border-radius:2px; }

.bubble {
  max-width:90%; padding:10px 13px; border-radius:var(--r);
  font-size:13px; line-height:1.55; animation:fu .2s ease;
}
@keyframes fu { from{opacity:0;transform:translateY(5px)} to{opacity:1;transform:translateY(0)} }

.ba { background:var(--surface); border:1px solid var(--border); align-self:flex-start; border-bottom-left-radius:3px; }
.ai-tag { display:block; font-size:10px; font-weight:700; letter-spacing:.6px; color:var(--moss); margin-bottom:4px; }
.bu { background:var(--moss-d); border:1px solid #1E4A30; color:var(--ink); align-self:flex-end; border-bottom-right-radius:3px; }

.rcards { display:flex; flex-direction:column; gap:5px; margin-top:6px; }
.rcard {
  background:var(--panel); border:1px solid var(--border); border-radius:9px;
  padding:8px 10px; cursor:pointer; transition:all .14s;
  display:flex; align-items:center; gap:8px;
}
.rcard:hover { border-color:var(--moss); transform:translateX(2px); }
.rcard.sel { border-color:var(--moss); background:var(--moss-d); }
.rcard-ico {
  width:24px; height:24px; border-radius:6px;
  background:var(--border); display:flex; align-items:center; justify-content:center;
  font-size:12px; flex-shrink:0;
}
.rcard-body { flex:1; min-width:0; }
.rcard-t { font-size:12px; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.rcard-s { font-size:11px; color:var(--ink-m); margin-top:1px; }
.rcard-chk {
  width:15px; height:15px; border-radius:50%; border:1.5px solid var(--border2);
  display:flex; align-items:center; justify-content:center;
  font-size:8px; color:transparent; transition:all .14s; flex-shrink:0;
}
.rcard.sel .rcard-chk { background:var(--moss); border-color:var(--moss); color:white; }

.thinking {
  display:flex; gap:4px; padding:10px 13px;
  background:var(--surface); border:1px solid var(--border); border-radius:var(--r);
  border-bottom-left-radius:3px; align-self:flex-start; align-items:center;
}
.tdot { width:5px; height:5px; background:var(--moss); border-radius:50%; animation:bounce 1.1s infinite; }
.tdot:nth-child(2){animation-delay:.18s} .tdot:nth-child(3){animation-delay:.36s}
@keyframes bounce{0%,100%{transform:translateY(0);opacity:.3}50%{transform:translateY(-4px);opacity:1}}

.cinput-row { display:flex; gap:6px; align-items:flex-end; flex-shrink:0; }
.cinput {
  flex:1; background:var(--surface); border:1px solid var(--border); border-radius:10px;
  padding:9px 13px; font-family:'DM Sans',sans-serif; font-size:13px; color:var(--ink);
  resize:none; outline:none; transition:border-color .16s; line-height:1.5;
  min-height:40px; max-height:100px;
}
.cinput:focus { border-color:var(--moss); }
.cinput::placeholder { color:var(--ink-m); }
.csend {
  width:36px; height:36px; border-radius:9px; border:none;
  background:var(--moss); color:white; font-size:15px; cursor:pointer;
  display:flex; align-items:center; justify-content:center; transition:all .16s; flex-shrink:0;
}
.csend:hover { background:var(--moss-l); transform:scale(1.05); }

/* ── EMAIL PANEL ── */
.ctx-pill {
  display:inline-flex; align-items:center; gap:6px;
  background:var(--moss-d); border:1px solid #1E4A30;
  border-radius:20px; padding:4px 10px 4px 8px;
  font-size:11px; color:var(--moss); font-weight:500; flex-shrink:0; align-self:flex-start;
}
.ctx-pill .rm { cursor:pointer; opacity:.5; margin-left:3px; font-size:11px; }
.ctx-pill .rm:hover { opacity:1; }

.sender-row {
  display:flex; align-items:center; gap:8px;
  padding:10px 14px; border-bottom:1px solid var(--border); flex-shrink:0;
}
.sender-label {
  font-size:10px; font-weight:700; letter-spacing:.7px;
  color:var(--ink-m); text-transform:uppercase; flex-shrink:0;
}
.sender-accounts {
  display:flex; gap:5px; flex:1; overflow-x:auto;
}
.sender-accounts::-webkit-scrollbar { display:none; }
.sender-opt {
  display:flex; align-items:center; gap:6px;
  padding:5px 10px; border-radius:20px; border:1px solid var(--border);
  background:transparent; cursor:pointer; transition:all .15s; flex-shrink:0;
  font-family:'DM Sans',sans-serif;
}
.sender-opt:hover { border-color:var(--border2); background:var(--border); }
.sender-opt.active { border-color:var(--moss); background:var(--moss-d); }
.sender-dot {
  width:7px; height:7px; border-radius:50%; flex-shrink:0;
}
.sender-name { font-size:11px; font-weight:500; color:var(--ink-s); }
.sender-opt.active .sender-name { color:var(--moss); }
.sender-email-text { font-size:10px; color:var(--ink-m); }
.sender-opt.active .sender-email-text { color:var(--moss); opacity:.7; }

.compose-wrap {
  flex:1; display:flex; flex-direction:column; min-height:0;
  background:var(--surface); border-radius:14px; border:1px solid var(--border);
  overflow:hidden;
}

.csubject-row {
  display:flex; align-items:center;
  border-bottom:1px solid var(--border); flex-shrink:0; gap:8px; padding-right:10px;
}
.csubject-input {
  flex:1; background:transparent; border:none; outline:none;
  padding:13px 16px; font-family:'DM Sans',sans-serif;
  font-size:14px; font-weight:600; color:var(--ink); letter-spacing:-0.2px;
}
.csubject-input::placeholder { color:var(--ink-m); font-weight:400; }

.ai-generate-btn {
  width:28px; height:28px; border-radius:8px; border:none;
  background:var(--border); color:var(--ink-s);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; transition:all .16s; flex-shrink:0; font-size:14px;
}
.ai-generate-btn:hover { background:var(--moss-d); color:var(--moss); transform:scale(1.08); }

.cbody-area {
  flex:1; display:flex; flex-direction:column; min-height:0; position:relative;
}

.cbody {
  flex:1; background:transparent; border:none; outline:none; resize:none;
  padding:14px 16px; font-family:'DM Sans',sans-serif;
  font-size:13px; line-height:1.8; color:var(--ink);
  min-height:0;
}
.cbody::placeholder { color:var(--ink-m); }

.compose-bar {
  display:flex; align-items:center; gap:4px;
  padding:8px 10px; border-top:1px solid var(--border); flex-shrink:0;
}

.cbar-btn {
  display:flex; align-items:center; gap:3px;
  padding:5px 9px; border-radius:7px; border:none;
  background:transparent; font-family:'DM Sans',sans-serif;
  font-size:11px; color:var(--ink-m); cursor:pointer; transition:all .13s; white-space:nowrap;
}
.cbar-btn:hover { background:var(--border); color:var(--ink); }
.cbar-sep { width:1px; height:14px; background:var(--border); flex-shrink:0; margin:0 3px; }

.cbar-save {
  margin-left:auto; padding:5px 13px; border-radius:7px;
  border:1px solid var(--border2); background:transparent;
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:500;
  color:var(--ink-s); cursor:pointer; transition:all .15s;
}
.cbar-save:hover { background:var(--border); color:var(--ink); }

/* ── RECIPIENTS PANEL ── */
.rsearch-row { display:flex; gap:6px; flex-shrink:0; }
.rsearch {
  flex:1; background:var(--surface); border:1px solid var(--border); border-radius:var(--r);
  padding:8px 12px; font-family:'DM Sans',sans-serif; font-size:12px; color:var(--ink);
  outline:none; transition:border-color .16s;
}
.rsearch:focus { border-color:var(--sky); }
.rsearch::placeholder { color:var(--ink-m); }
.add-btn {
  padding:7px 12px; border-radius:var(--r); border:1px solid #1E3A50;
  background:var(--sky-d); color:var(--sky);
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600; cursor:pointer; transition:all .16s; white-space:nowrap;
}
.add-btn:hover { background:var(--sky); color:white; border-color:var(--sky); }

.sec-label { font-size:10px; font-weight:700; letter-spacing:.9px; color:var(--ink-m); text-transform:uppercase; flex-shrink:0; }

.chips-area { display:flex; flex-wrap:wrap; gap:5px; min-height:24px; flex-shrink:0; }
.chip {
  display:flex; align-items:center; gap:5px; padding:3px 8px 3px 5px;
  border-radius:20px; background:var(--sky-d); border:1px solid #1E3A50;
  font-size:11px; color:var(--sky); font-weight:500; animation:fu .18s ease;
}
.chip-av { width:15px; height:15px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:7px; font-weight:700; color:white; }
.chip-rm { cursor:pointer; opacity:.45; font-size:11px; margin-left:1px; }
.chip-rm:hover { opacity:1; }
.no-r { font-size:11px; color:var(--ink-m); font-style:italic; }

.contacts-list { display:flex; flex-direction:column; gap:4px; overflow-y:auto; flex:1; min-height:0; }
.contacts-list::-webkit-scrollbar{width:3px}
.contacts-list::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}

.crow {
  display:flex; align-items:center; gap:8px; padding:8px 10px;
  border-radius:9px; border:1px solid transparent; background:var(--surface);
  cursor:pointer; transition:all .14s; flex-shrink:0;
}
.crow:hover { border-color:var(--sky); background:var(--panel); }
.crow.added { border-color:#1E3A50; background:var(--sky-d); }

.cav { width:28px; height:28px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:700; color:white; flex-shrink:0; }
.cinfo { flex:1; min-width:0; }
.cname { font-size:12px; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.cemail { font-size:10px; color:var(--ink-m); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.ctag { font-size:9px; font-weight:700; padding:2px 6px; border-radius:20px; flex-shrink:0; white-space:nowrap; letter-spacing:.3px; }
.ctag-add { background:var(--border); color:var(--ink-m); }
.ctag-added { background:var(--sky-d); color:var(--sky); border:1px solid #1E3A50; }

.send-summary {
  background:linear-gradient(135deg, var(--sky-d), var(--moss-d));
  border:1px solid #1E3A50; border-radius:var(--r);
  padding:12px; display:flex; align-items:center; gap:10px; flex-shrink:0;
}
.ss-ico { font-size:18px; }
.ss-text { flex:1; }
.ss-title { font-size:12px; font-weight:600; }
.ss-sub { font-size:10px; color:var(--ink-m); margin-top:2px; }
.send-now {
  padding:7px 14px; border-radius:20px; border:none; background:var(--blush); color:white;
  font-family:'DM Sans',sans-serif; font-size:11px; font-weight:700; cursor:pointer; transition:all .16s; white-space:nowrap;
}
.send-now:hover { background:#D97655; transform:translateY(-1px); box-shadow:0 4px 12px rgba(232,136,106,.35); }

.divider { height:1px; background:var(--border); flex-shrink:0; }

/* ── STATUS BAR ── */
.statusbar {
  height:24px; background:var(--surface); border-top:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
  padding:0 20px; flex-shrink:0;
}
.sl { display:flex; align-items:center; gap:5px; font-size:10px; color:var(--ink-m); }
.dot { width:5px; height:5px; border-radius:50%; background:var(--moss); animation:pulse 2s infinite; }
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.25}}
.sc { font-size:10px; color:var(--ink-m); font-style:italic; font-family:'Lora',serif; }

/* ── THREAD LIST (Research Panel) ── */
.tl-section {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  border-bottom: 1px solid var(--border);
}

/* Column header row */
.tl-cols {
  display: grid;
  grid-template-columns: 130px 1fr 54px;
  align-items: center;
  padding: 0 10px 6px 10px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 3px;
  flex-shrink: 0;
}

.tl-col-sender,
.tl-col-subject,
.tl-col-date {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: .8px;
  color: var(--ink-m);
  text-transform: uppercase;
}

.tl-col-date { text-align: right; }

/* Header cells need relative positioning for the drag handle */
.tl-col-hd {
  position: relative;
}

/* Drag handle — sits on the right edge of the header cell */
.col-resizer {
  position: absolute;
  right: -4px;
  top: -3px;
  bottom: -3px;
  width: 8px;
  cursor: col-resize;
  z-index: 3;
  display: flex;
  align-items: center;
  justify-content: center;
}

.col-resizer::after {
  content: '';
  width: 2px;
  height: 100%;
  border-radius: 1px;
  background: var(--border2);
  transition: background .15s;
}

.col-resizer:hover::after,
.col-resizer:active::after {
  background: var(--moss);
}

.tl-list {
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  max-height: 260px;
  padding: 0 10px 10px;
  gap: 3px;
}

.tl-list::-webkit-scrollbar { width: 3px; }
.tl-list::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

/* Thread item — grid row matching column headers */
.ti {
  display: grid;
  grid-template-columns: 130px 1fr 54px;
  align-items: center;
  padding: 7px 9px;
  border-radius: 8px;
  border: 1px solid transparent;
  cursor: pointer;
  transition: all .14s;
  flex-shrink: 0;
}

.ti:hover { background: var(--surface); border-color: var(--border); }
.ti.active { background: var(--moss-d); border-color: var(--moss); }

/* Sender cell */
.ti-col-sender {
  display: flex;
  align-items: center;
  gap: 7px;
  min-width: 0;
  padding-right: 8px;
}

.ti-recipient {
  font-size: 11px;
  font-weight: 600;
  color: var(--ink);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.ti.active .ti-recipient { color: var(--moss); }

/* Subject cell */
.ti-col-subject {
  min-width: 0;
  padding-right: 6px;
  display: flex;
  align-items: center;
}

.ti-subject {
  font-size: 11px;
  font-weight: 400;
  color: var(--ink-s);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: block;
}

.ti.active .ti-subject { color: var(--moss); opacity: .85; }

/* Unread = bold text, like a real email client */
.ti.unread .ti-subject {
  font-weight: 600;
  color: var(--ink);
}

.ti.unread .ti-recipient {
  font-weight: 700;
  color: var(--ink);
}

.ti.unread .ti-time {
  color: var(--ink-s);
  font-weight: 500;
}

/* Date cell */
.ti-col-date {
  display: flex;
  justify-content: flex-end;
}

.ti-time {
  font-size: 10px;
  color: var(--ink-m);
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

/* Thread chat section — fixed height below the primary email body */
.thread-chat {
  flex: 0 0 230px;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
  border-top: 1px solid var(--border);
}

/* Context header bar */
.tctx {
  display: flex;
  align-items: center;
  gap: 9px;
  padding: 10px 14px;
  background: var(--moss-d);
  border-bottom: 1px solid var(--moss);
  flex-shrink: 0;
}

.tctx-ico { font-size: 14px; flex-shrink: 0; }

.tctx-info { flex: 1; min-width: 0; }

.tctx-subject {
  font-size: 11px;
  font-weight: 600;
  color: var(--moss);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tctx-name {
  font-size: 10px;
  color: var(--ink-m);
  margin-top: 1px;
}

.tctx-close {
  flex-shrink: 0;
  width: 22px;
  height: 22px;
  border-radius: 6px;
  border: none;
  background: transparent;
  color: var(--ink-m);
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all .14s;
}

.tctx-close:hover {
  background: var(--border);
  color: var(--ink);
}

/* Chat area inside thread panel */
.tl-chat-area {
  flex: 1;
  padding: 12px 12px 8px;
}

/* Empty state */
.tl-empty {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  color: var(--ink-m);
  padding-bottom: 20px;
}

.tl-empty-ico { font-size: 26px; opacity: .4; }

.tl-empty-text {
  font-size: 11px;
  text-align: center;
  line-height: 1.6;
  opacity: .6;
}

/* ── THREAD DETAIL VIEW ── */

/* Header bar: back button + thread subject/recipient */
.detail-header {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 14px 16px 12px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

.back-btn {
  padding: 5px 10px;
  border-radius: 7px;
  border: 1px solid var(--border2);
  background: transparent;
  color: var(--moss);
  font-family: 'DM Sans', sans-serif;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all .15s;
  flex-shrink: 0;
  white-space: nowrap;
}
.back-btn:hover { background: var(--moss-d); border-color: var(--moss); }

.detail-meta {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.detail-subject {
  font-size: 12px;
  font-weight: 600;
  color: var(--ink);
  line-height: 1.4;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.detail-recipient {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  color: var(--ink-m);
}

/* ── Primary email body area (fills most vertical space) ── */
.email-primary {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Scrollable body content */
.email-body-scroll {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-height: 0;
}
.email-body-scroll::-webkit-scrollbar { width: 3px; }
.email-body-scroll::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

/* Sender row */
.email-body-from {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
}
.ebf-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--ink);
}
.ebf-label {
  font-size: 9px;
  color: var(--ink-m);
  margin-top: 2px;
  letter-spacing: .4px;
}

/* The actual email text */
.email-body-text {
  font-size: 13px;
  line-height: 1.8;
  color: var(--ink);
  padding: 14px 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px;
  white-space: pre-wrap;
}

/* ── Thread history — collapsible ── */
.thread-history {
  flex-shrink: 0;
  border-top: 1px solid var(--border);
}

.history-toggle {
  width: 100%;
  padding: 7px 16px;
  display: flex;
  align-items: center;
  gap: 6px;
  background: transparent;
  border: none;
  color: var(--ink-m);
  font-family: 'DM Sans', sans-serif;
  font-size: 11px;
  cursor: pointer;
  transition: all .15s;
  text-align: left;
}
.history-toggle:hover { background: var(--surface); color: var(--ink); }
.ht-arrow { font-size: 8px; }

/* Expanded history list */
.history-list {
  overflow-y: auto;
  max-height: 180px;
  display: flex;
  flex-direction: column;
}
.history-list::-webkit-scrollbar { width: 3px; }
.history-list::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }

/* Each earlier message row */
.history-msg {
  display: flex;
  flex-direction: column;
  gap: 3px;
  padding: 8px 16px;
  border-top: 1px solid var(--border);
}
.hmsg-from {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .6px;
  color: var(--ink-m);
}
.hmsg-me .hmsg-from { color: var(--moss); }
.hmsg-text {
  font-size: 11px;
  color: var(--ink-m);
  line-height: 1.5;
}
.hmsg-me .hmsg-text { color: var(--ink-s); }

/* ── TOAST ── */
.toast {
  position:fixed; bottom:38px; left:50%; transform:translateX(-50%) translateY(10px);
  background:#0A0A0D; color:var(--ink); border:1px solid var(--border2);
  padding:8px 18px; border-radius:30px; font-size:12px;
  opacity:0; transition:all .24s; z-index:100; pointer-events:none; white-space:nowrap;
}
.toast.show { opacity:1; transform:translateX(-50%) translateY(0); }

/* ── THREAD HISTORY TOGGLE BUTTON ── */
.thread-history-btn {
  padding: 5px 10px;
  border-radius: 7px;
  border: 1px solid var(--border2);
  background: var(--moss-d);
  color: var(--moss);
  font-family: 'DM Sans', sans-serif;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all .16s;
  white-space: nowrap;
  margin-left: auto;
}
.thread-history-btn:hover {
  background: var(--moss);
  color: white;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(78, 184, 122, 0.3);
}

/* ── THREAD HISTORY SLIDE-IN PANEL ── */
.thread-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  z-index: 200;
  animation: fadeIn 0.2s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.thread-history-panel {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 480px;
  max-width: 90vw;
  background: var(--panel);
  border-left: 1px solid var(--border);
  z-index: 201;
  display: flex;
  flex-direction: column;
  animation: slideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  box-shadow: -4px 0 24px rgba(0, 0, 0, 0.4);
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.thread-panel-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 20px 20px 16px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
  background: var(--surface);
}

.thread-panel-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--ink);
  font-family: 'Lora', serif;
  margin-bottom: 4px;
}

.thread-panel-subtitle {
  font-size: 11px;
  color: var(--ink-m);
  line-height: 1.4;
}

.thread-panel-close {
  width: 28px;
  height: 28px;
  border-radius: 7px;
  border: none;
  background: transparent;
  color: var(--ink-m);
  font-size: 14px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all .15s;
  flex-shrink: 0;
}

.thread-panel-close:hover {
  background: var(--border);
  color: var(--ink);
}

.thread-panel-messages {
  flex: 1;
  overflow-y: auto;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 0;
  min-height: 0;
}

.thread-panel-messages::-webkit-scrollbar {
  width: 3px;
}

.thread-panel-messages::-webkit-scrollbar-thumb {
  background: var(--border2);
  border-radius: 2px;
}

.thread-panel-msg {
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 14px 16px;
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  animation: fu 0.3s ease;
  flex-shrink: 0;
}

.thread-panel-msg:first-child {
  border-top: 1px solid var(--border);
}

.thread-panel-msg.msg-me {
  background: var(--moss-d);
  border-bottom-color: #1E4A30;
}

.thread-msg-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.thread-msg-from {
  font-size: 12px;
  font-weight: 600;
  color: var(--ink);
  flex: 1;
}

.thread-msg-badge {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  color: var(--moss);
  background: var(--moss-d);
  padding: 3px 8px;
  border-radius: 12px;
  border: 1px solid var(--moss);
}

.thread-msg-text {
  font-size: 13px;
  line-height: 1.8;
  color: var(--ink-s);
  white-space: pre-wrap;
}

.thread-panel-msg.msg-me .thread-msg-text {
  color: var(--ink);
}
